--转二层type值为0x88cclldp链路层发现协议的包：
sudo tcpdump -i wlo1 -en 'ether[12]==0x88 and ether[13]==0xcc' -vv
tcpdump: listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
10:56:09.368254 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204
	Chassis ID TLV (1), length 7
	  Subtype MAC address (4): 08:11:96:7d:08:f8
	  0x0000:  0408 1196 7d08 f8
	Port ID TLV (2), length 7
	  Subtype MAC address (3): 08:11:96:7d:08:f8
	  0x0000:  0308 1196 7d08 f8
	Time to Live TLV (3), length 2: TTL 120s
	  0x0000:  0078
	System Name TLV (5), length 2: HP
	  0x0000:  4850
	System Description TLV (6), length 100
	  Ubuntu Kylin 16.04.7 LTS Linux 4.4.0-206-generic #238-Ubuntu SMP Tue Mar 16 07:52:37 UTC 2021 x86_64
	  0x0000:  5562 756e 7475 204b 796c 696e 2031 362e
	  0x0010:  3034 2e37 204c 5453 204c 696e 7578 2034
	  0x0020:  2e34 2e30 2d32 3036 2d67 656e 6572 6963
	  0x0030:  2023 3233 382d 5562 756e 7475 2053 4d50
	  0x0040:  2054 7565 204d 6172 2031 3620 3037 3a35
	  0x0050:  323a 3337 2055 5443 2032 3032 3120 7838
	  0x0060:  365f 3634
	System Capabilities TLV (7), length 4
	  System  Capabilities [Bridge, WLAN AP, Router, Station Only] (0x009c)
	  Enabled Capabilities [WLAN AP] (0x0008)
	  0x0000:  009c 0008
	Management Address TLV (8), length 12
	  Management Address length 5, AFI IPv4 (1): 192.168.124.2
	  Interface Index Interface Numbering (2): 3
	  0x0000:  0501 c0a8 7c02 0200 0000 0300
	Management Address TLV (8), length 24
	  Management Address length 17, AFI IPv6 (2): fe80::b096:d8d1:f4da:b3f
	  Interface Index Interface Numbering (2): 3
	  0x0000:  1102 fe80 0000 0000 0000 b096 d8d1 f4da
	  0x0010:  0b3f 0200 0000 0300
	Port Description TLV (4), length 4: wlo1
	  0x0000:  776c 6f31
	Organization specific TLV (127), length 9: OUI IEEE 802.3 Private (0x00120f)
	  Link aggregation Subtype (3)
	    aggregation status [supported], aggregation port ID 0
	  0x0000:  0012 0f03 0100 0000 00
	Organization specific TLV (127), length 9: OUI IEEE 802.3 Private (0x00120f)
	  MAC/PHY configuration/status Subtype (1)
	    autonegotiation [none] (0x00)
	    PMD autoneg capability [unknown] (0x0000)
	    MAU type Unknown (0x0000)
	  0x0000:  0012 0f01 0000 0000 00
	End TLV (0), length 0

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 -en 'ether[12]==0x88 and ether[13]==0xcc'
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
10:58:09.430129 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
10:58:39.445389 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
10:59:09.456732 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP

==== -A 显示ascii码不带二层头部的信息，用户调试80端口的网页程序====

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 -A host youdao.com and port 80
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes



12:28:53.145009 IP 192.168.124.2.50900 > 103.72.47.249.http: Flags [S], seq 3715838174, win 29200, options [mss 1460,sackOK,TS val 2025289 ecr 0,nop,wscale 7], length 0
E..<]%@.@.	...|.gH/....P.{0.......r.E..........
...I........
12:28:53.153520 IP 103.72.47.249.http > 192.168.124.2.50900: Flags [S.], seq 3232737061, ack 3715838175, win 28960, options [mss 1460,sackOK,TS val 1885803370 ecr 2025289,nop,wscale 9], length 0
E..<..@.8.n.gH/...|..P.....%.{0...q ZS.........
pg.j...I...	
12:28:53.153587 IP 192.168.124.2.50900 > 103.72.47.249.http: Flags [.], ack 1, win 229, options [nop,nop,TS val 2025291 ecr 1885803370], length 0
E..4]&@.@.	...|.gH/....P.{0....&.....Z.....
...Kpg.j
12:28:53.153755 IP 192.168.124.2.50900 > 103.72.47.249.http: Flags [P.], seq 1:75, ack 1, win 229, options [nop,nop,TS val 2025292 ecr 1885803370], length 74: HTTP: GET / HTTP/1.1
E..~]'@.@.	g..|.gH/....P.{0....&...........
...Lpg.jGET / HTTP/1.1
Host: youdao.com
User-Agent: curl/7.47.0
Accept: */*


12:28:53.172543 IP 103.72.47.249.http > 192.168.124.2.50900: Flags [.], ack 75, win 57, options [nop,nop,TS val 1885803388 ecr 2025292], length 0
E..4.^@.8..ugH/...|..P.....&.{1)...9.......
pg.|...L
12:28:53.177181 IP 103.72.47.249.http > 192.168.124.2.50900: Flags [.], seq 1:1441, ack 75, win 57, options [nop,nop,TS val 1885803392 ecr 2025292], length 1440: HTTP: HTTP/1.1 200 OK
E...._@.8...gH/...|..P.....&.{1)...9.......
pg.....LHTTP/1.1 200 OK
Server: nginx
Date: Sun, 04 Apr 2021 04:28:53 GMT
Content-Type: text/html; charset=utf-8
Transfer-Encoding: chunked
Connection: keep-alive
Vary: Accept-Encoding
Cache-Control: private
Content-Language: en-US
Set-Cookie: DICT_UGC=be3af0da19b5c5e6aa4e17bd8d90b28a|; domain=.youdao.com
Set-Cookie: OUTFOX_SEARCH_USER_ID=171527213@120.244.10.201; domain=.youdao.com; expires=Tue, 28-Mar-2051 04:28:52 GMT
Set-Cookie: JSESSIONID=abcDuu9YIZ0CW7KAajBIx; domain=youdao.com; path=/

2535
<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="keywords" content="......, ......, ......, ......, ........., ......, ........., .................., ............, ............, ............, ............, ............, ............, ............"><meta name="description" content="..................................................................100%............................................................2006........................................................................................................................................................................2014............................................................2018...4.........................................................11.2....................................2019...10............................................................DAO......................................................"><title>............</title><link href=
12:28:53.177221 IP 192.168.124.2.50900 > 103.72.47.249.http: Flags [.], ack 1441, win 251, options [nop,nop,TS val 2025297 ecr 1885803392], length 0
E..4](@.@.	...|.gH/....P.{1).........>.....
...Qpg..
12:28:53.211951 IP 103.72.47.249.http > 192.168.124.2.50900: Flags [F.], seq 10042, ack 76, win 57, options [nop,nop,TS val 1885803428 ecr 2025298], length 0
E..4.f@.8..mgH/...|..P....._.{1*...9.@.....
pg.....R
12:28:53.212002 IP 192.168.124.2.50900 > 103.72.47.249.http: Flags [.], ack 10043, win 386, options [nop,nop,TS val 2025306 ecr 1885803428], length 0
E..4]0@.@.	...|.gH/....P.{1*...`...........
...Zpg..


zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ curl youdao.com
<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="keywords" content="有道, 搜索, 词典, 翻译, 云笔记, 笔记, 惠惠网, 惠惠购物助手, 购物搜索, 图片搜索, 视频搜索, 新闻搜索, 网易有道, 在线翻译, 专业翻译"><meta name="description" content="网易有道是中国领先的智能学习公司，致力于提供100%以用户为导向的学习产品和服务。有道成立于2006年，打造了一系列深受用户喜欢的口碑型大众学习工具产品，例如：网易有道词典、有道精品课、有道翻译官、有道云笔记等。2014年，网易有道宣布正式进军互联网教育行业。2018年4月，网易有道完成首次战略融资，投后估值11.2亿美金，跻身独角兽阵营。2019年10月，网易有道成功登陆纽交所，股票代码为“DAO”，成为网易集团首个独立上市的公司。"><title>有道首页</title><link href="https://shared.ydstatic.com/images/favicon.ico" type="image/x-icon" rel="shortcut icon"><link rel="stylesheet" href="https://shared.ydstatic.com/dict/v2016/entry/pc12.css"><script>var _rlog = _rlog || [];
    // 指定 product id
    _rlog.push(["_setAccount", "dictweb"]);
    _rlog.push(["_addPost", "page", "index"]);</script></head><body><div id="nav"><a id="wljb" href="http://report.12377.cn:13225/toreportinputNormal_anis.do" target="_blank"></a><div id="more"><div><span></span> 更多产品</div><div class="menu"><ul><li><a href="https://cidian.youdao.com/index.html"><span class="icon_cidian"></span><div>网易有道词典</div></a></li><li><a href="https://kiddict.youdao.com/"><span class="icon_shaoercidian"></span><div>有道少儿词典</div></a></li><li><a href="https://speak.youdao.com/"><span class="icon_kouyu"></span><div>有道口语</div></a></li><li><a href="https://ke.youdao.com/"><span class="icon_jingpinke"></span><div>有道精品课</div></a></li><li><a href="https://fanyiguan.youdao.com/?keyfrom=about.youdao"><span class="icon_fanyiguan"></span><div>有道翻译官</div></a></li><li><a href="https://recite.youdao.com/"><span class="icon_beidanci"></span><div>有道背单词</div></a></li><li><a href="https://note.youdao.com/?keyfrom=about.youdao"><span class="icon_yunbiji"></span><div>有道云笔记</div></a></li><li><a href="https://co.youdao.com/product.html?keyfrom=website"><span class="icon_xiezuo"></span><div>有道云协作</div></a></li><li><a href="https://zhushou.huihui.cn/"><span class="icon_huihui"></span><div>惠惠购物助手</div></a></li><li><a href="https://store.youdao.com/#/general"><span class="icon_fanyiwang"></span><div>有道翻译王</div></a></li><li><a href="http://dsp.youdao.com/dsp/website/developer.shtml?keyfrom=dict2.index"><span class="icon_zhixuan"></span><div>有道智选</div></a></li><li><a href="https://ai.youdao.com/"><span class="icon_zhiyun"></span><div>有道智云</div></a></li><li><a href="https://write.youdao.com"><span class="icon_writing"></span><div>有道写作</div></a></li><li><a href="https://pdf.youdao.com"><span class="icon_translate"></span><div>有道文档翻译</div></a></li><li><a href="https://sight.youdao.com"><span class="icon_regard"></span><div>网易见外</div></a></li><li><a target="_blank" href="http://www.youdao.com/about/?keyfrom=dict2.index">全部产品</a></li></ul></div></div><ul><li><a target="_blank" href="http://tongdao.youdao.com/index.html" class="plan">同道计划 <span class="new_icon"></span></a></li><li><a href="http://www.huihui.cn/?keyfrom=dict2.index">惠惠</a></li><li><a href="http://f.youdao.com/?keyfrom=dict2.index">人工翻译</a></li><li><a href="http://note.youdao.com/?keyfrom=dict2.index">云笔记</a></li><li><a href="https://ke.youdao.com/?keyfrom=dict2.index">精品课</a></li><li><a href="http://fanyi.youdao.com/?keyfrom=dict2.index">翻译</a></li><li><a href="https://recite.youdao.com/?vendor=chanpindaohang">背单词</a></li><li><a href="https://smart.youdao.com/">学习硬件</a></li><li><a href="http://dict.youdao.com/?keyfrom=dict2.index">词典</a></li></ul></div><div id="margin1"></div><div id="logo"><div class="logo"></div></div><div id="margin2"></div><div id="search"><div class="wrap"><form method="GET" action="/search" id="form"><img class="logo" src="https://shared-https.ydstatic.com/dict/v2016/logo.png" alt="有道图标"><div id="selectType"><div id="type">中英</div><div class="side">1</div><span class="arrow"></span><ul id="typeList"><li>中英</li><li>中法</li><li>中韩</li><li>中日</li></ul></div><div id="border"><input type="text" name="le" id="translateType" value="eng"> <input type="text" name="q" onmouseover="this.focus()" onfocus="this.select()" maxlength="256" id="translateContent" autocomplete="off" placeholder="在此输入要翻译的单词或文字"> <input type="hidden" name="keyfrom" value="dict2.index"> <span id="hnwBtn" class="hand-write"></span></div><button>翻译</button></form></div></div><div id="margin3"><span><a target="_blank" href="http://c.youdao.com/dict/download.html?app=dict&vendor=webdict_default&platform=win&url=http%3A%2F%2Fcodown.youdao.com%2Fcidian%2FYoudaoDict_webdict_default.exe">下载词典客户端 </a></span>| <span><a target="_blank" href="http://cidian.youdao.com/mobile.html?keyfrom=dict2.index">下载词典移动端 </a></span>| <span><a target="_blank" href="http://dict.youdao.com/wordbook/wordlist?keyfrom=dict2.index">查看单词本 </a></span>| <span class="ugc-link"><a target="_blank" href="http://pdf.youdao.com">文档翻译 <sup>&bull; </sup></a></span>| <span class="ugc-link"><a target="_blank" href="https://write.youdao.com">有道写作 <sup>&bull; </sup></a></span><span class="ugc-link"><a target="_blank" href="https://ai.youdao.com">词典 API <sup>&bull;</sup></a></span></div><div id="doc2"><div class="wrap"><div class="fl"><div class="channel"><div class="popout"><div class="container"><span class="active">精选阅读 </span><span>必备课程</span></div></div></div><div id="vista"></div><div id="course"><div class="category"><span class="active">四六级 </span><span>考研 </span><span>实用英语</span></div><div id="CET" class="cate start"></div><div id="IELTS" class="cate start"></div><div id="Kaoyan" class="cate start"></div><div id="GRE" class="cate start"></div><div id="Practical" class="cate start"></div></div><div id="discount" class="start"></div></div><div class="fr"><div class="popout"><iframe src="https://c.youdao.com/www/banner.html" frameborder="0"></iframe></div></div></div></div><div id="footer"><div class="wrap"><ul><li><a href="http://www.youdao.com/about/">关于有道</a></li><li><a href="http://ir.youdao.com/">Investors</a></li><li><a href="http://dsp.youdao.com/">有道智选</a></li><li><a href="http://ai.youdao.com/?keyfrom=dict2.index">有道智云</a></li><li><a href="http://i.youdao.com/">官方博客</a></li><li><a href="http://techblog.youdao.com/">技术博客</a></li><li><a href="http://campus.youdao.com/index.php?t1=index">诚聘英才</a></li><li><a href="http://shared.youdao.com/www/contactus-page.html">联系我们</a></li><li><a href="http://dict.youdao.com/map/index.html">站点地图</a></li><li><a href="http://www.12377.cn/">网络举报</a></li><li><a href="http://shared.youdao.com/images/license/businessLicense.png">营业执照</a></li><li><a href="https://jubao.163.com/">网易廉政举报</a></li><li><a href="http://shared.youdao.com/images/license/publicationLicense.png">出版物经营许可证</a></li><li><a href="http://shared.youdao.com/images/Broadcastingandtelevisionprogramproductionlicense.pdf">广播电视节目制造许可证</a></li></ul><p class="phone">违法和不良信息举报电话：010-82558163 廉政举报：jb@rd.netease.com <span class="copy-right">&copy;<script>document.write(new Date().getFullYear());</script><a href="http://www.163.com/">网易公司</a> <a href="http://shared.youdao.com/dict/market/youdaoInc-v2.1/index.html#/CN">隐私政策</a> <a href="http://xue.youdao.com/sw/m/1191866">服务条款</a> 京ICP证080268号 <a href="http://beian.miit.gov.cn">京ICP备10005211号 </a><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802020092" style="margin-left: 5px;
                display: inline-block;
                text-decoration: none;
                vertical-align: -9%"><img src="https://shared.ydstatic.com/images/icons/jgw.jpg" style="float: left; width: 14px"> <span style="float: left; line-height: 17px">京公网安备 11010802020092号</span></a></span></p></div></div><a id="backToTop" href="javascript:void(0);">返回到顶部</a><div id="handWrite" class="pm" style="display: none"><object width="346" height="216" type="application/x-shockwave-flash" id="hnw" data="https://shared.ydstatic.com/dict/v5.16/swf/Hnw.swf"><param name="movie" value="${DictStaticBase}swf/Hnw.swf"><param name="menu" value="false"><param name="allowScriptAccess" value="always"></object></div><div id="callback"></div><script src="https://shared.ydstatic.com/js/jquery/jquery-1.12.3.min.js"></script><script src="https://shared.ydstatic.com/dict/v2016/entry/jquery.mousewheel.js"></script><script src="https://shared.ydstatic.com/dict/v2016/entry/jquery.placeholder.js"></script><script src="https://shared.ydstatic.com/dict/v2016/entry/autocomplete_json.js"></script><script src="https://shared.ydstatic.com/dict/v2016/entry/pc5.js"></script><script defer="defer" src="https://shared.ydstatic.com/js/rlog/v1.js"></script></body></html>zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ 


==== signal SIGUSR1 for tcpdump count, 发SIGUSR1信号让tcpdump打印当前包的接受情况====

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ ps -ef |grep tcpdump
root      5296  3377  0 12:44 pts/1    00:00:00 sudo tcpdump -i wlo1 -en ether[12]==0x88 and ether[13]==0xcc
root      5297  5296  0 12:44 pts/1    00:00:00 tcpdump -i wlo1 -en ether[12]==0x88 and ether[13]==0xcc
zhangly   5329  4170  0 12:47 pts/18   00:00:00 grep --color=auto tcpdump
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo kill -s SIGUSR1 5297
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo kill -s SIGUSR1 5297

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 -en 'ether[12]==0x88 and ether[13]==0xcc'
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes


12:44:43.847092 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
^T^T
^T^T12:45:13.877336 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:45:43.907535 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:46:13.937779 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:46:43.943212 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:47:13.962779 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:47:43.967157 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
tcpdump: 7 packets captured, 7 packets received by filter, 0 packets dropped by kernel
12:48:13.997407 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:48:44.017355 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:49:14.032989 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:49:44.060369 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:50:14.080140 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:50:44.089832 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:51:14.108595 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
12:51:44.138791 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
tcpdump: 15 packets captured, 15 packets received by filter, 0 packets dropped by kernel


==== 设置包个数，抓够退出 ====
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 -en 'ether[12]==0x88 and ether[13]==0xcc' -c 2
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
14:37:48.317875 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
14:38:18.342707 08:11:96:7d:08:f8 > 01:80:c2:00:00:0e, ethertype LLDP (0x88cc), length 218: LLDP, length 204: HP
2 packets captured
2 packets received by filter
0 packets dropped by kernel

==== -C 设置产生输出文件大小 ====

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -s 
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size: 85.3 KByte (default)
------------------------------------------------------------


大小设置1(M)
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i lo -w iperf.cap -C 1

--开始打流量
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 10000000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 57844 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec  9.62 MBytes  19.6 Gbits/sec


结束后查看生成文件情况：
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ ls -lrt
总用量 2552
-rw-r--r-- 1 root    root    1052912 4月   4 17:08 iperf.cap1
-rw-r--r-- 1 root    root    1053423 4月   4 17:08 iperf.cap
-rw-r--r-- 1 root    root     460879 4月   4 17:08 iperf.cap2
-rw-rw-r-- 1 zhangly zhangly   20486 4月   4 17:15 tcpdump.log


===== -D for get interface list, 获取接口列表====

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ tcpdump -D
1.wlo1 [Up, Running]
2.any (Pseudo-device that captures on all interfaces) [Up, Running]
3.lo [Up, Running, Loopback]
4.enp0s25 [Up]
5.bluetooth0 (Bluetooth adapter number 0)
6.nflog (Linux netfilter log (NFLOG) interface)
7.nfqueue (Linux netfilter queue (NFQUEUE) interface)
8.usbmon1 (USB bus number 1)
9.usbmon2 (USB bus number 2)
10.usbmon3 (USB bus number 3)
11.usbmon4 (USB bus number 4)

==== -e show the link level (mac address) information, 显示mac地址信息=====

zhangly@HP:~/source/ikuai_gitsrc$ sudo tcpdump -i wlo1 arp -vv
tcpdump: listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
12:08:43.786485 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.124.2 (08:11:96:7d:08:f8 (oui Unknown)) tell moshujia.cn, length 46
12:08:43.786508 ARP, Ethernet (len 6), IPv4 (len 4), Reply 192.168.124.2 is-at 08:11:96:7d:08:f8 (oui Unknown), length 28
^C
2 packets captured
2 packets received by filter
0 packets dropped by kernel
zhangly@HP:~/source/ikuai_gitsrc$ sudo tcpdump -i wlo1 arp -vv -e
tcpdump: listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
12:08:48.802749 08:11:96:7d:08:f8 (oui Unknown) > 04:d7:a5:5e:d2:f6 (oui Unknown), ethertype ARP (0x0806), length 42: Ethernet (len 6), IPv4 (len 4), Request who-has moshujia.cn tell 192.168.124.2, length 28
12:08:48.804855 04:d7:a5:5e:d2:f6 (oui Unknown) > 08:11:96:7d:08:f8 (oui Unknown), ethertype ARP (0x0806), length 42: Ethernet (len 6), IPv4 (len 4), Reply moshujia.cn is-at 04:d7:a5:5e:d2:f6 (oui Unknown), length 28
^C
2 packets captured
2 packets received by filter
0 packets dropped by kernel

==== -C 以秒为单位循环输出文件，和-w配合使用，如果指定大小，则按大小分割 =====

设定每一秒为一个单位循环输出
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i lo -w tcpdump.cap -C 1 -G 1


第一次执行以后
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60236 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  3.01 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ 


zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ ls -lrht
总用量 1.1M
-rw-r--r-- 1 root    root    150K 4月   5 14:33 tcpdump.cap2
-rw-r--r-- 1 root    root    814K 4月   5 14:34 tcpdump.cap1
-rw-r--r-- 1 root    root     87K 4月   5 14:35 tcpdump.cap
-rw-rw-r-- 1 zhangly zhangly  23K 4月   5 14:38 tcpdump.log
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ 


多执行几次

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60642 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  8.13 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60644 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  3.10 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60646 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  3.50 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60648 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  3.45 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60650 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  8.74 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60652 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  2.46 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60654 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  5.76 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60656 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  2.89 Gbits/sec
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ iperf -c 127.0.0.1 -n 100000
------------------------------------------------------------
Client connecting to 127.0.0.1, TCP port 5001
TCP window size: 2.50 MByte (default)
------------------------------------------------------------
[  3] local 127.0.0.1 port 60658 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 0.0 sec   128 KBytes  2.99 Gbits/sec

输出文件没有增加

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ ls -lrth
总用量 1.1M
-rw-r--r-- 1 root    root    150K 4月   5 14:33 tcpdump.cap2
-rw-r--r-- 1 root    root    814K 4月   5 14:34 tcpdump.cap1
-rw-rw-r-- 1 zhangly zhangly  24K 4月   5 14:40 tcpdump.log
-rw-r--r-- 1 root    root     87K 4月   5 14:41 tcpdump.cap


==== --immediate-mode 收到包立即输出，在输出到屏幕的情况下，也是默认的====

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 --immediate-mode
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
16:38:39.618762 IP 192.168.124.2.56834 > 103.39.76.66.https: Flags [S], seq 1847247609, win 29200, options [mss 1460,sackOK,TS val 4689408 ecr 0,nop,wscale 7], length 0
16:38:39.620246 IP 192.168.124.2.56712 > moshujia.cn.domain: 35157+ PTR? 66.76.39.103.in-addr.arpa. (43)
16:38:39.620281 IP 192.168.124.2.56712 > public1.114dns.com.domain: 35157+ PTR? 66.76.39.103.in-addr.arpa. (43)
16:38:39.637465 IP moshujia.cn.domain > 192.168.124.2.56712: 35157 NXDomain 0/0/0 (43)
16:38:39.637987 IP 192.168.124.2.56712 > moshujia.cn.domain: 34005+ PTR? 2.124.168.192.in-addr.arpa. (44)
16:38:39.646804 IP moshujia.cn.domain > 192.168.124.2.56712: 34005 NXDomain* 0/0/0 (44)
16:38:39.647430 IP 192.168.124.2.56712 > moshujia.cn.domain: 30980+ PTR? 114.114.114.114.in-addr.arpa. (46)
16:38:39.649004 IP public1.114dns.com.domain > 192.168.124.2.56712: 35157 NXDomain 0/1/0 (131)
16:38:39.657541 IP moshujia.cn.domain > 192.168.124.2.56712: 30980 1/0/0 PTR public1.114dns.com. (78)
16:38:40.278207 IP moshujia.cn.37091 > 255.255.255.255.mmcc: UDP, length 16
16:38:40.278425 IP 192.168.124.2.56712 > moshujia.cn.domain: 13154+ PTR? 255.255.255.255.in-addr.arpa. (46)
16:38:40.278468 IP moshujia.cn.58533 > 255.255.255.255.987: UDP, length 19
16:38:40.297622 IP moshujia.cn.domain > 192.168.124.2.56712: 13154* 0/0/0 (46)
16:38:40.802773 IP 192.168.124.2.56836 > 103.39.76.66.https: Flags [S], seq 766574595, win 29200, options [mss 1460,sackOK,TS val 4689704 ecr 0,nop,wscale 7], length 0
16:38:40.834746 IP 192.168.124.2.56838 > 103.39.76.66.https: Flags [S], seq 3055625007, win 29200, options [mss 1460,sackOK,TS val 4689712 ecr 0,nop,wscale 7], length 0
^C
15 packets captured
15 packets received by filter
0 packets dropped by kernel

=== -j and -J set stamp types and show stamp types 设置和显示时间戳种类，例子只支持主机时间戳====

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ tcpdump -J
Time stamp types for wlo1 (use option -j to set):
  host (Host)
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ 
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 --immediate-mode -j host
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
17:24:55.955365 IP 192.168.124.2.37478 > 36.152.44.205.https: Flags [P.], seq 4088956464:4088956509, ack 1176864446, win 237, length 45
17:24:55.956523 IP 192.168.124.2.56712 > moshujia.cn.domain: 45370+ PTR? 205.44.152.36.in-addr.arpa. (44)
17:24:55.956556 IP 192.168.124.2.56712 > public1.114dns.com.domain: 45370+ PTR? 205.44.152.36.in-addr.arpa. (44)
17:24:55.965655 IP moshujia.cn.domain > 192.168.124.2.56712: 45370 NXDomain 0/0/0 (44)
17:24:55.966502 IP 192.168.124.2.56712 > moshujia.cn.domain: 63470+ PTR? 2.124.168.192.in-addr.arpa. (44)
17:24:55.979520 IP 36.152.44.205.https > 192.168.124.2.37478: Flags [.], ack 45, win 1076, length 0
17:24:55.979560 IP moshujia.cn.domain > 192.168.124.2.56712: 63470 NXDomain* 0/0/0 (44)
17:24:55.980491 IP 192.168.124.2.56712 > moshujia.cn.domain: 24124+ PTR? 114.114.114.114.in-addr.arpa. (46)
17:24:55.984501 IP moshujia.cn.domain > 192.168.124.2.56712: 24124 1/0/0 PTR public1.114dns.com. (78)
17:24:55.988101 IP public1.114dns.com.domain > 192.168.124.2.56712: 45370 NXDomain 0/0/0 (44)
^C
10 packets captured
12 packets received by filter
2 packets dropped by kernel

=== -l 查看数据包完成内容 ====

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -l | tee dat
[sudo] zhangly 的密码： 
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
18:47:18.322065 ARP, Request who-has 192.168.124.2 (08:11:96:7d:08:f8 (oui Unknown)) tell moshujia.cn, length 46
18:47:18.322100 ARP, Reply 192.168.124.2 is-at 08:11:96:7d:08:f8 (oui Unknown), length 28
18:47:18.584232 IP 192.168.124.2.56712 > moshujia.cn.domain: 28329+ PTR? 2.124.168.192.in-addr.arpa. (44)
18:47:18.584259 IP 192.168.124.2.56712 > public1.114dns.com.domain: 28329+ PTR? 2.124.168.192.in-addr.arpa. (44)
18:47:18.592733 IP moshujia.cn.domain > 192.168.124.2.56712: 28329 NXDomain* 0/0/0 (44)
18:47:18.616114 IP public1.114dns.com.domain > 192.168.124.2.56712: 28329 NXDomain* 0/1/0 (79)
18:47:19.582911 IP 192.168.124.2.56712 > moshujia.cn.domain: 15285+ PTR? 114.114.114.114.in-addr.arpa. (46)
18:47:19.593640 IP moshujia.cn.domain > 192.168.124.2.56712: 15285 1/0/0 PTR public1.114dns.com. (78)
^C8 packets captured
8 packets received by filter
0 packets dropped by kernel

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ cat dat 
18:47:18.322065 ARP, Request who-has 192.168.124.2 (08:11:96:7d:08:f8 (oui Unknown)) tell moshujia.cn, length 46
18:47:18.322100 ARP, Reply 192.168.124.2 is-at 08:11:96:7d:08:f8 (oui Unknown), length 28
18:47:18.584232 IP 192.168.124.2.56712 > moshujia.cn.domain: 28329+ PTR? 2.124.168.192.in-addr.arpa. (44)
18:47:18.584259 IP 192.168.124.2.56712 > public1.114dns.com.domain: 28329+ PTR? 2.124.168.192.in-addr.arpa. (44)
18:47:18.592733 IP moshujia.cn.domain > 192.168.124.2.56712: 28329 NXDomain* 0/0/0 (44)
18:47:18.616114 IP public1.114dns.com.domain > 192.168.124.2.56712: 28329 NXDomain* 0/1/0 (79)
18:47:19.582911 IP 192.168.124.2.56712 > moshujia.cn.domain: 15285+ PTR? 114.114.114.114.in-addr.arpa. (46)
18:47:19.593640 IP moshujia.cn.domain > 192.168.124.2.56712: 15285 1/0/0 PTR public1.114dns.com. (78)

=== -N 打印简化域名 ====

未设置之前

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 --immediate-mode -j host
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
22:25:04.350865 IP moshujia.cn.1900 > 239.255.255.250.1900: UDP, length 294
22:25:04.351180 IP moshujia.cn.1900 > 239.255.255.250.1900: UDP, length 303

设置之后：

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 --immediate-mode -j host -N
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
22:25:18.277820 IP 192.168.124.2.56712 > moshujia.domain: 65483+ PTR? 12.124.168.192.in-addr.arpa. (45)
22:25:18.289257 IP moshujia.domain > 192.168.124.2.56712: 65483 NXDomain* 0/0/0 (45)


==== --number show packge number at beginning of the line ====

第一列输出即是：

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 --immediate-mode -j host --number
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
    1  22:39:40.406930 ARP, Request who-has 192.168.124.2 (08:11:96:7d:08:f8 (oui Unknown)) tell moshujia.cn, length 46
    2  22:39:40.406997 ARP, Reply 192.168.124.2 is-at 08:11:96:7d:08:f8 (oui Unknown), length 28
    3  22:39:40.408349 IP 192.168.124.2.56712 > moshujia.cn.domain: 60714+ PTR? 2.124.168.192.in-addr.arpa. (44)
    4  22:39:40.408377 IP 192.168.124.2.56712 > public1.114dns.com.domain: 60714+ PTR? 2.124.168.192.in-addr.arpa. (44)
    5  22:39:40.422191 IP moshujia.cn.domain > 192.168.124.2.56712: 60714 NXDomain* 0/0/0 (44)
    6  22:39:40.423271 IP 192.168.124.2.56712 > moshujia.cn.domain: 45080+ PTR? 114.114.114.114.in-addr.arpa. (46)
    7  22:39:40.439762 IP public1.114dns.com.domain > 192.168.124.2.56712: 60714 NXDomain* 0/1/0 (79)
    8  22:39:40.447168 IP moshujia.cn.domain > 192.168.124.2.56712: 45080 1/0/0 PTR public1.114dns.com. (78)
    9  22:39:43.098618 LLDP, length 204: HP
   10  22:39:44.397455 IP moshujia.cn.37091 > 255.255.255.255.mmcc: UDP, length 16
   11  22:39:44.397718 IP moshujia.cn.58533 > 255.255.255.255.987: UDP, length 19
   12  22:39:44.398059 IP 192.168.124.2.56712 > moshujia.cn.domain: 45970+ PTR? 255.255.255.255.in-addr.arpa. (46)
   13  22:39:44.423464 IP moshujia.cn.domain > 192.168.124.2.56712: 45970* 0/0/0 (46)
^C
13 packets captured
13 packets received by filter
0 packets dropped by kernel

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i wlo1 --immediate-mode -j host -#
[sudo] zhangly 的密码： 
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), capture size 262144 bytes
    1  23:21:35.965664 IP moshujia.cn.1900 > 239.255.255.250.1900: UDP, length 362
    2  23:21:35.965841 IP moshujia.cn.1900 > 239.255.255.250.1900: UDP, length 356
    3  23:21:35.966110 IP moshujia.cn.1900 > 239.255.255.250.1900: UDP, length 358
    4  23:21:35.966485 IP 192.168.124.2.56712 > moshujia.cn.domain: 51899+ PTR? 250.255.255.239.in-addr.arpa. (46)
    5  23:21:35.966522 IP 192.168.124.2.56712 > public1.114dns.com.domain: 51899+ PTR? 250.255.255.239.in-addr.arpa. (46)
    6  23:21:35.977367 IP moshujia.cn.domain > 192.168.124.2.56712: 51899 NXDomain 0/0/0 (46)
    7  23:21:35.978206 IP 192.168.124.2.56712 > moshujia.cn.domain: 32713+ PTR? 2.124.168.192.in-addr.arpa. (44)
    8  23:21:35.996388 IP moshujia.cn.domain > 192.168.124.2.56712: 32713 NXDomain* 0/0/0 (44)
    9  23:21:35.997142 IP 192.168.124.2.56712 > moshujia.cn.domain: 19782+ PTR? 114.114.114.114.in-addr.arpa. (46)
   10  23:21:35.997969 IP public1.114dns.com.domain > 192.168.124.2.56712: 51899 NXDomain 0/1/0 (103)
   11  23:21:36.005047 IP moshujia.cn.domain > 192.168.124.2.56712: 19782 1/0/0 PTR public1.114dns.com. (78)
   12  23:21:36.477556 IP moshujia.cn.37091 > 255.255.255.255.mmcc: UDP, length 16
   13  23:21:36.477735 IP moshujia.cn.58533 > 255.255.255.255.987: UDP, length 19
   14  23:21:36.478069 IP 192.168.124.2.56712 > moshujia.cn.domain: 31598+ PTR? 255.255.255.255.in-addr.arpa. (46)
   15  23:21:36.487498 IP moshujia.cn.domain > 192.168.124.2.56712: 31598* 0/0/0 (46)
   16  23:21:37.911155 IP 192.168.124.3.60819 > 239.255.255.250.1900: UDP, length 152
   17  23:21:37.911687 IP 192.168.124.2.56712 > moshujia.cn.domain: 1026+ PTR? 3.124.168.192.in-addr.arpa. (44)
   18  23:21:37.924343 IP moshujia.cn.domain > 192.168.124.2.56712: 1026 NXDomain* 0/0/0 (44)
^C
18 packets captured
18 packets received by filter
0 packets dropped by kernel

===== -q quick output, output lines are shorter 少的输出组合上打印行数的 ========
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i any -q --number
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on any, link-type LINUX_SLL (Linux cooked), capture size 262144 bytes
    1  22:40:01.461739 IP moshujia.cn.37091 > 255.255.255.255.mmcc: UDP, length 16
    2  22:40:01.461852 IP moshujia.cn.58533 > 255.255.255.255.987: UDP, length 19
    3  22:40:01.462922 IP localhost.41252 > HP.domain: UDP, length 46
    4  22:40:01.463116 IP 192.168.124.2.59583 > moshujia.cn.domain: UDP, length 46
    5  22:40:01.463153 IP 192.168.124.2.59583 > public1.114dns.com.domain: UDP, length 46
    6  22:40:01.495403 IP moshujia.cn.domain > 192.168.124.2.59583: UDP, length 46
    7  22:40:01.496237 IP localhost.33570 > HP.domain: UDP, length 44
    8  22:40:01.496345 IP 192.168.124.2.59583 > moshujia.cn.domain: UDP, length 44

==== -S  Print absolute, rather than relative, TCP sequence numbers. 打印tcp绝对的序列号，而不是相对的=====

以下是绝对的

zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -S -i lo tcp and port 8888
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on lo, link-type EN10MB (Ethernet), capture size 262144 bytes
23:31:14.611061 IP localhost.57238 > localhost.8888: Flags [P.], seq 3126491315:3126491320, ack 201624152, win 342, options [nop,nop,TS val 1356657 ecr 1083881], length 5
23:31:14.611096 IP localhost.8888 > localhost.57238: Flags [.], ack 3126491320, win 342, options [nop,nop,TS val 1356657 ecr 1356657], length 0
23:31:22.248644 IP localhost.57238 > localhost.8888: Flags [P.], seq 3126491320:3126491325, ack 201624152, win 342, options [nop,nop,TS val 1358566 ecr 1356657], length 5
23:31:22.248678 IP localhost.8888 > localhost.57238: Flags [.], ack 3126491325, win 342, options [nop,nop,TS val 1358566 ecr 1358566], length 0
^C
4 packets captured
8 packets received by filter
0 packets dropped by kernel

以下是默认不带参数的相对的
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i lo tcp and port 8888
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on lo, link-type EN10MB (Ethernet), capture size 262144 bytes
23:32:21.090536 IP localhost.57238 > localhost.8888: Flags [P.], seq 3126491325:3126491330, ack 201624152, win 342, options [nop,nop,TS val 1373276 ecr 1358566], length 5
23:32:21.090563 IP localhost.8888 > localhost.57238: Flags [.], ack 5, win 342, options [nop,nop,TS val 1373276 ecr 1373276], length 0
23:32:24.785212 IP localhost.57238 > localhost.8888: Flags [P.], seq 5:10, ack 1, win 342, options [nop,nop,TS val 1374200 ecr 1373276], length 5
23:32:24.785235 IP localhost.8888 > localhost.57238: Flags [.], ack 10, win 342, options [nop,nop,TS val 1374200 ecr 1374200], length 0
23:32:57.960817 IP localhost.57238 > localhost.8888: Flags [F.], seq 10, ack 1, win 342, options [nop,nop,TS val 1382494 ecr 1374200], length 0
23:32:57.961044 IP localhost.8888 > localhost.57238: Flags [F.], seq 1, ack 11, win 342, options [nop,nop,TS val 1382494 ecr 1382494], length 0
23:32:57.961108 IP localhost.57238 > localhost.8888: Flags [.], ack 2, win 342, options [nop,nop,TS val 1382494 ecr 1382494], length 0
^C
7 packets captured
14 packets received by filter
0 packets dropped by kernel

==== -s set package size and show the protocol where trancat at which protocol 设置包大小，在截断处显示截断的那层的协议名 =====
zhangly@HP:~$ sudo tcpdump -i any -s 20
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on any, link-type LINUX_SLL (Linux cooked), capture size 20 bytes
22:58:33.993854 IP [|ip]
22:58:34.526485 
	0x0000:  0207 0408                                ....
22:58:35.245877 [|ARP]
22:58:35.880118 [|ARP]
22:58:35.880160 [|ARP]
22:58:39.052263 IP [|ip]
^C
6 packets captured
6 packets received by filter
0 packets dropped by kernel
zhangly@HP:~$ man tcpdump
zhangly@HP:~$ sudo tcpdump -i any -s 50
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on any, link-type LINUX_SLL (Linux cooked), capture size 50 bytes
22:59:34.041470 IP 192.168.124.8.49154 > 255.255.255.255.6667: UDP, length 188
22:59:34.042828 IP localhost.42489 > HP.domain: [|domain]
22:59:34.043028 IP 192.168.124.2.40980 > moshujia.cn.domain: [|domain]
22:59:34.050913 IP moshujia.cn.domain > 192.168.124.2.40980: [|domain]
22:59:34.051140 IP HP.domain > localhost.42489: [|domain]
22:59:34.051592 IP localhost.56177 > HP.domain: [|domain]
22:59:34.051753 IP 192.168.124.2.40980 > moshujia.cn.domain: [|domain]
22:59:34.059613 IP moshujia.cn.domain > 192.168.124.2.40980: [|domain]
22:59:34.059838 IP HP.domain > localhost.56177: [|domain]
22:59:34.060379 IP localhost.48213 > HP.domain: [|domain]
22:59:34.060551 IP 192.168.124.2.40980 > moshujia.cn.domain: [|domain]
22:59:34.072734 IP moshujia.cn.domain > 192.168.124.2.40980: [|domain]
22:59:34.072956 IP HP.domain > localhost.48213: [|domain]
22:59:34.554642 
	0x0000:  0207 0408 1196 7d08 f804 0703 0811 967d  ......}........}
	0x0010:  08f8 0602 0078 0a02 4850 0c64 5562 756e  .....x..HP.dUbun
	0x0020:  7475                                     tu
22:59:35.271082 ARP, Request who-has 192.168.124.8 tell 192.168.124.8, length 28
22:59:35.878487 ARP, Request who-has 192.168.124.2 (08:11:96:7d:08:f8 (oui Unknown)) tell moshujia.cn, length 46
22:59:35.878542 ARP, Reply 192.168.124.2 is-at 08:11:96:7d:08:f8 (oui Unknown), length 28
22:59:36.350873 IP 192.168.124.2.46594 > server-13-33-171-22.maa50.r.cloudfront.net.https: [|tcp]
22:59:36.351279 IP localhost.57024 > HP.domain: [|domain]
22:59:36.351516 IP 192.168.124.2.40980 > moshujia.cn.domain: [|domain]
22:59:36.351562 IP 192.168.124.2.40980 > public1.114dns.com.domain: [|domain]
22:59:36.417142 IP moshujia.cn.domain > 192.168.124.2.40980: [|domain]
22:59:36.417390 IP HP.domain > localhost.57024: [|domain]
22:59:36.417928 IP localhost.52844 > HP.domain: [|domain]
22:59:36.418103 IP 192.168.124.2.40980 > moshujia.cn.domain: [|domain]
22:59:36.426728 IP moshujia.cn.domain > 192.168.124.2.40980: [|domain]
22:59:36.426973 IP HP.domain > localhost.52844: [|domain]
^C
27 packets captured
37 packets received by filter
0 packets dropped by kernel

==== -t dont print time stamp =====
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i any -t
[sudo] zhangly 的密码： 
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on any, link-type LINUX_SLL (Linux cooked), capture size 262144 bytes
IP 192.168.124.8.49154 > 255.255.255.255.6667: UDP, length 188
IP localhost.36047 > HP.domain: 34336+ PTR? 255.255.255.255.in-addr.arpa. (46)
IP 192.168.124.2.48312 > moshujia.cn.domain: 26152+ PTR? 255.255.255.255.in-addr.arpa. (46)
IP moshujia.cn.domain > 192.168.124.2.48312: 26152* 0/0/0 (46)
IP HP.domain > localhost.36047: 34336* 0/0/0 (46)
IP localhost.45116 > HP.domain: 49719+ PTR? 2.124.168.192.in-addr.arpa. (44)
IP 192.168.124.2.48312 > moshujia.cn.domain: 57654+ PTR? 2.124.168.192.in-addr.arpa. (44)
^C
7 packets captured
19 packets received by filter
9 packets dropped by kernel
zhangly@HP:~/source/ikuai_gitsrc/tcpdump$ sudo tcpdump -i any 
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on any, link-type LINUX_SLL (Linux cooked), capture size 262144 bytes
23:01:06.340586 IP moshujia.cn.37091 > 255.255.255.255.mmcc: UDP, length 16
23:01:06.340803 IP moshujia.cn.58533 > 255.255.255.255.987: UDP, length 19
23:01:06.341364 IP localhost.58754 > HP.domain: 49725+ PTR? 255.255.255.255.in-addr.arpa. (46)
23:01:06.341567 IP 192.168.124.2.48312 > moshujia.cn.domain: 2221+ PTR? 255.255.255.255.in-addr.arpa. (46)
23:01:06.341603 IP 192.168.124.2.48312 > public1.114dns.com.domain: 2221+ PTR? 255.255.255.255.in-addr.arpa. (46)
23:01:06.353588 IP moshujia.cn.domain > 192.168.124.2.48312: 2221* 0/0/0 (46)
23:01:06.354442 IP localhost.39587 > HP.domain: 53934+ PTR? 2.124.168.192.in-addr.arpa. (44)
23:01:06.354614 IP 192.168.124.2.48312 > moshujia.cn.domain: 58173+ PTR? 2.124.168.192.in-addr.arpa. (44)
23:01:06.372134 IP public1.114dns.com.domain > 192.168.124.2.48312: 2221* 0/1/0 (81)
^C
9 packets captured
22 packets received by filter
10 packets dropped by kernel

